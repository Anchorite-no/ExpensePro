<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tag Cloud Demo (Wordle Style)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wordcloud2.js/1.2.2/wordcloud2.min.js"></script>
    <style>
        :root {
            --bg: #f8fafc;
            --surface: #ffffff;
            --text: #1e293b;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 800px;
            background: var(--surface);
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        h2 { margin-top: 0; margin-bottom: 20px; font-size: 18px; color: #334155; }

        /* Canvas container */
        .cloud-wrapper {
            width: 100%;
            height: 500px;
            position: relative;
            background: #fff;
            border: 1px dashed #cbd5e1;
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        .controls {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        button {
            padding: 8px 16px;
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }
        
        button:hover { background: #e2e8f0; border-color: #cbd5e1; }
        button.active { background: #3b82f6; color: white; border-color: #3b82f6; }
        button.primary { background: #3b82f6; color: white; border-color: #3b82f6; font-weight: 500; }
        button.primary:hover { background: #2563eb; }

    </style>
</head>
<body>

<div class="container">
    <h2>多彩标签云 (Wordle 风格)</h2>
    
    <div class="cloud-wrapper" id="canvas-container">
        <canvas id="my_canvas"></canvas>
    </div>

    <div class="controls">
        <button class="primary" onclick="renderCloud()">⟳ 刷新布局</button>
        <div style="width: 100%; height: 0;"></div> <!-- Break line -->
        
        <span>形状:</span>
        <button class="shape-btn active" onclick="setShape(this, 'circle')">圆形</button>
        <button class="shape-btn" onclick="setShape(this, 'cardioid')">心形</button>
        <button class="shape-btn" onclick="setShape(this, 'diamond')">菱形</button>
        <button class="shape-btn" onclick="setShape(this, 'triangle-forward')">三角形</button>
        <button class="shape-btn" onclick="setShape(this, 'star')">五角星</button>
    </div>
    
    <p style="font-size: 12px; color: #94a3b8; margin-top: 10px;">
        提示：使用了多种柔和的莫兰迪色系，支持不同形状的填充。
    </p>
</div>

<script>
    // 模拟数据： [标签名, 权重/频率]
    const tags = [
        ['餐饮', 60], ['外卖', 45], ['交通', 40], ['地铁', 35],
        ['购物', 38], ['零食', 32], ['水果', 28], ['聚会', 36],
        ['房租', 50], ['水电', 25], ['话费', 22], ['医疗', 20],
        ['打车', 24], ['电影', 26], ['咖啡', 30], ['奶茶', 28],
        ['衣服', 34], ['日用品', 25], ['买菜', 30], ['加油', 28],
        ['停车', 20], ['早饭', 25], ['午饭', 35], ['晚饭', 40],
        ['旅行', 22], ['机票', 28], ['酒店', 26], ['门票', 18],
        ['运动', 24], ['健身', 30], ['游泳', 20], ['书籍', 16],
        ['游戏', 22], ['充值', 18], ['理发', 25], ['护肤', 32],
        ['礼物', 28], ['红包', 35], ['捐款', 12], ['彩票', 10],
        ['维修', 15], ['保养', 20], ['洗车', 18], ['过路费', 14],
        ['快递', 16], ['宽带', 24], ['会员', 22], ['订阅', 18]
    ];

    let currentShape = 'circle';

    // 莫兰迪色系 / 多彩配色
    const colors = [
        '#E63946', '#F1FAEE', '#A8DADC', '#457B9D', '#1D3557', // Classic
        '#2A9D8F', '#E9C46A', '#F4A261', '#E76F51', // Earth
        '#845EC2', '#D65DB1', '#FF6F91', '#FF9671', '#FFC75F', '#F9F871', // Vibrant
        '#008744', '#0057e7', '#d62d20', '#ffa700'  // Google-ish
    ];
    
    // 生成随机颜色的函数
    function getRandomColor() {
        // 方法1: 从预设调色板取
        // return colors[Math.floor(Math.random() * colors.length)];
        
        // 方法2: 随机生成高饱和度颜色 (HSL)
        const hue = Math.floor(Math.random() * 360);
        return `hsl(${hue}, 70%, 50%)`;
    }

    function renderCloud() {
        const canvas = document.getElementById('my_canvas');
        const container = document.getElementById('canvas-container');
        
        // 设置 Canvas 分辨率
        canvas.width = container.offsetWidth;
        canvas.height = container.offsetHeight;

        // 清空画布
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        WordCloud(canvas, {
            list: tags,
            gridSize: Math.round(16 * canvas.width / 1024),
            weightFactor: function (size) {
                return Math.pow(size, 2.3) * canvas.width / 1024 * 0.15; // 指数缩放让大的更大
            },
            fontFamily: 'Impact, "Microsoft YaHei", sans-serif', // 用粗体更好看
            color: function (word, weight) {
                return getRandomColor();
            },
            rotateRatio: 0.5, // 50% 概率旋转
            rotationSteps: 2, // 仅 0 和 90 度
            backgroundColor: '#ffffff',
            shape: currentShape,
            drawOutOfBound: false,
            shrinkToFit: true,
            minSize: 4 // 最小字体大小
        });
    }

    function setShape(btn, shape) {
        // Update active button
        document.querySelectorAll('.shape-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        currentShape = shape;
        renderCloud();
    }

    // 页面加载完成后渲染
    window.onload = () => {
        setTimeout(renderCloud, 100);
    };
    
    window.onresize = () => {
        renderCloud();
    };

</script>

</body>
</html>
